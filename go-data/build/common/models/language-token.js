"use strict";const _=require("lodash"),uuid=require("uuid"),app=require("../../server/server");module.exports=function(e){e.hasController=!1,e.generateID=function(e,t){return e.length>900&&(e=`${e.substring(0,100)}_${_.snakeCase(uuid.v4().toUpperCase())}`),`${e}_${_.snakeCase(t).toUpperCase()}`},e.observe("before save",function(t,n){const o=app.utils.helpers.getSourceAndTargetFromModelHookContext(t);if(o.source.all.token){const e=o.source.all.token.substr(0,128);e!==o.source.all.tokenSortKey&&(o.target.tokenSortKey=e)}return t.options&&t.options._sync?n():t.isNewInstance?(t.instance.id=e.generateID(t.instance.token,t.instance.languageId),void n()):n()})};