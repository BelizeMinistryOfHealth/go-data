"use strict";const app=require("../../server/server"),path=require("path");module.exports=function(e){e.upload=function(t,n,a,i,o,r,p){app.utils.remote.helpers.parseMultipartRequest(n,["attachmentId","name"],["file"],e,["attachmentId"],function(n,a,i){if(n)return p(n);e.saveOnDisk(i.file).then(function(n){return e.create({id:a.attachmentId,outbreakId:t,name:a.name,originalName:i.file.name,mimeType:i.file.type,path:n},r)}).then(function(e){p(null,e)}).catch(p)})},e.prototype.download=function(t){const n=this;e.readFromDisk(this.path).then(function(e){const a=path.extname(n.path);app.utils.remote.helpers.offerFileToDownload(e,n.mimeType&&n.mimeType.length?n.mimeType:"application/octet-stream",`${n.name}${a}`,t)}).catch(t)}};