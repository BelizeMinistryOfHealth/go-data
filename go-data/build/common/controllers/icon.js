"use strict";const app=require("../../server/server"),path=require("path");module.exports=function(e){app.utils.remote.disableRemoteMethods(e,["create","prototype.patchAttributes"]),e.upload=function(t,n,a,o,r){app.utils.remote.helpers.parseMultipartRequest(t,["name"],["icon"],e,[],function(t,n,a){if(t)return r(t);e.saveOnDisk(a.icon.path).then(function(t){return e.create({name:n.name,path:t},o)}).then(function(e){r(null,e)}).catch(r)})},e.prototype.download=function(t){const n=this;e.readFromDisk(this.path).then(function(e){const a=path.extname(n.path).replace(".","");app.utils.remote.helpers.offerFileToDownload(e,`image/${a}`,`${n.name}.${a}`,t)}).catch(t)}};