"use strict";const svgCaptcha=require("svg-captcha"),app=require("../../server/server");module.exports=function(r){r.generateSVG=function(r,e,t){const s=app.utils.helpers.getCaptchaConfig();try{const a=svgCaptcha.create();if(e.remotingContext.req.session)switch(r){case"login":if(!s.login)return app.logger.error('Failed creating svg captcha; "Login captcha is disabled"'),t(app.utils.apiError.getError("DISABLED_CAPTCHA"));e.remotingContext.req.session.loginCaptcha=a.text;break;case"forgot-password":if(!s.forgotPassword)return app.logger.error('Failed creating svg captcha; "Forgot password captcha is disabled"'),t(app.utils.apiError.getError("DISABLED_CAPTCHA"));e.remotingContext.req.session.forgotPasswordCaptcha=a.text;break;case"reset-password-questions":if(!s.resetPasswordQuestions)return app.logger.error('Failed creating svg captcha; "Reset password questions captcha is disabled"'),t(app.utils.apiError.getError("DISABLED_CAPTCHA"));e.remotingContext.req.session.resetPasswordQuestionsCaptcha=a.text}t(null,a.data)}catch(r){app.logger.error(`Failed creating svg captcha; ${r}`),t(r)}}};