"use strict";const getDeepFieldsMap=function(e){let n={};return Array.isArray(e)&&e.length&&e.forEach(function(e){const t=e.replace(/\[]/g,""),r=t.indexOf(".");if(-1===r)n[t]=!0;else{const e=t.substring(0,r),i=t.substring(r+1);n[e]=getDeepFieldsMap([i])}}),n},anonymize=function(e,n){let t;if(Array.isArray(n)){if(!n.length)return;t=getDeepFieldsMap(n)}else t=n;Array.isArray(e)?e.forEach(function(e){anonymize(e,n)}):Object.keys(e).forEach(function(n){t[n]&&("object"==typeof t[n]&&e[n]&&"object"==typeof e[n]?anonymize(e[n],t[n]):!0===t[n]&&(e[n]="***"))})};module.exports={anonymize:anonymize};