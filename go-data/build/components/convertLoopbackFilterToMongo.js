"use strict";const helpers=require("./helpers"),moment=require("moment"),checkIfDateAndConvert=function(e){if("string"==typeof e&&helpers.isValidDate(e)){let t=moment(e);t.isValid()&&(e=t.toDate())}return e},convertProps=function(e){for(let t in e)if(e.hasOwnProperty(t))if("between"===t)Array.isArray(e[t])&&(e.$gte=checkIfDateAndConvert(e[t][0]),e.$lte=checkIfDateAndConvert(e[t][1])),delete e[t];else if("$regex"===t){if("string"==typeof e[t]&&/\/(.+)\/(.*)/.test(e[t])){let r=/\/(.+)\/(.*)/.exec(e[t]);e[t]=new RegExp(r[1],r[2])}}else"object"==typeof e[t]&&null!==e[t]?convertProps(e[t]):e[t]=checkIfDateAndConvert(e[t])};function convert(e){const t=JSON.parse(JSON.stringify(e).replace(/"and"/g,'"$and"').replace(/"or"/g,'"$or"').replace(/"inq"/g,'"$in"').replace(/"nin"/g,'"$nin"').replace(/"id"/g,'"_id"').replace(/"lt"/g,'"$lt"').replace(/"lte"/g,'"$lte"').replace(/"gt"/g,'"$gt"').replace(/"gte"/g,'"$gte"').replace(/"regexp"/g,'"$regex"').replace(/"eq"/g,'"$eq"').replace(/"neq"/g,'"$ne"').replace(/"ne"/g,'"$ne"').replace(/"exists"/g,'"$exists"').replace(/"not"/g,'"$not"').replace(/"elemMatch"/g,'"$elemMatch"').replace(/"type":"null"/g,'"$type":"null"'));return convertProps(t),t}module.exports=convert;