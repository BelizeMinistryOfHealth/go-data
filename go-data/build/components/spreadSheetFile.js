"use strict";const xlsx=require("xlsx");function buildSpreadSheet(e,l){let t=[];if(e)if(l.length)l.forEach(function(l){const s={};e.forEach(function(e){s[e.header]=l[e.id]}),t.push(s)});else{const l={};e.forEach(function(e){l[e.header]=""}),t.push(l)}else t=l;return xlsx.utils.json_to_sheet(t)}function createCsvFile(e,l,t){const s=buildSpreadSheet(e,l);t(null,xlsx.utils.sheet_to_csv(s))}function createExcelFile(e,l,t,s){const c=buildSpreadSheet(e,l),i=xlsx.utils.book_new();xlsx.utils.book_append_sheet(i,c),s(null,xlsx.write(i,{type:"buffer",bookType:t}))}function createXlsFile(e,l,t){createExcelFile(e,l,"biff8",t)}function createXlsxFile(e,l,t){createExcelFile(e,l,"xlsx",t)}function createOdsFile(e,l,t){createExcelFile(e,l,"ods",t)}module.exports={createCsvFile:createCsvFile,createXlsFile:createXlsFile,createXlsxFile:createXlsxFile,createOdsFile:createOdsFile};