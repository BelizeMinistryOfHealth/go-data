"use strict";const crypto=require("crypto"),algorithm="aes-256-ctr",keyLength=32,ivLength=16,saltLength=8,digest="sha256",iterations=1e4;function createKeyIv(t,e){const r=crypto.randomBytes(saltLength),n=crypto.randomBytes(ivLength);crypto.pbkdf2(t,r,iterations,keyLength,digest,function(t,c){t&&e(t),e(null,{salt:r,key:c,iv:n})})}function encrypt(t,e){return new Promise(function(r,n){createKeyIv(t,function(t,c){if(t)return n(t);e&&e instanceof Object&&e.data&&"Buffer"===e.type&&(e=Buffer.from(e.data));const i=crypto.createCipheriv(algorithm,c.key,c.iv),o=Buffer.concat([c.iv,c.salt,i.update(e),i.final()]);r(o)})})}function decrypt(t,e){return new Promise(function(r,n){const c=Buffer.from(e),i=c.slice(0,ivLength),o=c.slice(ivLength,ivLength+saltLength),a=c.slice(ivLength+saltLength);crypto.pbkdf2(t,o,iterations,keyLength,digest,function(t,e){if(t)return n(t);let c,o;try{const t=crypto.createCipheriv(algorithm,e,i);o=Buffer.concat([t.update(a),t.final()])}catch(t){c=new Error("Failed to decrypt config properties. Stack Trace: "+t.stack)}if(c)return n(c);r(o)})})}module.exports={encrypt:encrypt,decrypt:decrypt};