"use strict";const pdfUtils=require("../pdfDoc"),doc=pdfUtils.createPdfDoc({fontSize:6,layout:"landscape",margin:20,lineGap:0,wordSpacing:0,characterSpacing:0,paragraphGap:0});doc.on("pageAdded",()=>{doc.moveDown(2)});const worker={sendData:function(e,n,o,t=!1){pdfUtils.addTitle(doc,e.title,14),doc.moveDown(2);const c=Object.keys(o).length;let d=0;!function o(s){const r=Object.keys(s);if(!r.length)return process.send([null,{readyForNextBatch:!0}]);const l=r.pop(),a=s[l];delete s[l];const f=doc.x;pdfUtils.addTitle(doc,`${e.groupTitle}: ${a.name}`,12),doc.moveDown(1),pdfUtils.createTableInPDFDocument(n,a.records,doc,null,null,function(){doc.x=f,pdfUtils.addTitle(doc,`${e.total}: ${a.records.length}`,12),doc.moveDown(2),(!t||d<Object.keys(c).length-1)&&doc.addPage(),d++,o(s)})}(o)},finish:function(){doc.end()}};let buffers=[],end=!1;!function e(){buffers.length&&(process.send([null,{chunk:Buffer.concat(buffers)}]),buffers=[]),end?process.send([null,{end:!0}]):setTimeout(e,1e3)}(),doc.on("data",function(e){buffers.push(e)}),doc.on("end",function(){end=!0}),process.on("message",function(e){worker[e.fn](...e.args)});