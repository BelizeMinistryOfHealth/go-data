"use strict";const app=require("../server");function authenticationErrorHandler(r,s,i,o){r&&"AUTHORIZATION_REQUIRED"===r.code&&s.authData&&(Array.isArray(s.missingPermissions)&&s.missingPermissions.length&&(r=app.utils.apiError.getError("MISSING_REQUIRED_PERMISSION",{permissions:s.missingPermissions.join(", ")},403)),Array.isArray(s.accessErrors)&&s.accessErrors.length&&(r=app.utils.apiError.getError("ACCESS_DENIED",{accessErrors:s.accessErrors.join(", ")},403)),Array.isArray(s.authorizationErrors)&&s.authorizationErrors.length&&(r=app.utils.apiError.getError("AUTHORIZATION_REQUIRED",{authorizationErrors:s.authorizationErrors.join(", ")}))),o(r)}module.exports=function(){return authenticationErrorHandler};